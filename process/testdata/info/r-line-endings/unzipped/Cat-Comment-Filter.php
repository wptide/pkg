<?php /*Plugin Name: 大猫评论内容关键词过滤Plugin URI: http://www.yiduqiang.com/Description: 过滤评论者或文章中不应该出现的词汇。Version: 1.0.1Author: 一堵墙Author URI: http://www.yiduqiang.com/*/if(get_option('Cat-Comment-Filter-1')==''){update_option('Cat-Comment-Filter-1','a');}if(get_option('Cat-Comment-Filter-2')==''){update_option('Cat-Comment-Filter-2','X');}if(get_option('Cat-Comment-Filter-3')==''){update_option('Cat-Comment-Filter-3','a');}if(get_option('Cat-Comment-Filter-4')==''){update_option('Cat-Comment-Filter-4','aaaaaaaa@@@bbbbbb');}if(get_option('Cat-Comment-Filter-5')==''){update_option('Cat-Comment-Filter-5','@@@');}if(get_option('Cat-Comment-Filter-6')==''){update_option('Cat-Comment-Filter-6','空白');}if(get_option('Cat-Comment-Filter-7')==''){update_option('Cat-Comment-Filter-7','a');}if(get_option('Cat-Comment-Filter-8')==''){update_option('Cat-Comment-Filter-8','a');}if(get_option('Cat-Comment-Filter-9')==''){update_option('Cat-Comment-Filter-9','a');}if(get_option('Cat-Comment-Filter-10')==''){update_option('Cat-Comment-Filter-10','a');}if(get_option('Cat-Comment-Filter-11')==''){update_option('Cat-Comment-Filter-11','a');}if(get_option('Cat-Comment-Filter-15')==''){update_option('Cat-Comment-Filter-15','a');}if(get_option('Cat-Comment-Filter-16')==''){update_option('Cat-Comment-Filter-16','a');}if(get_option('Cat-Comment-Filter-17')==''){update_option('Cat-Comment-Filter-17','b');}if(get_option('Cat-Comment-Filter-18')==''){update_option('Cat-Comment-Filter-18','b');}if(get_option('Cat-Comment-Filter-19')==''){update_option('Cat-Comment-Filter-19','a');}if(get_option('Cat-Comment-Filter-20')==''){update_option('Cat-Comment-Filter-20','b');}if(get_option('Cat-Comment-Filter-21')==''){update_option('Cat-Comment-Filter-21','b');}if(get_option('Cat-Comment-Filter-22')==''){update_option('Cat-Comment-Filter-22','a');}if(get_option('Cat-Comment-Filter-23')==''){update_option('Cat-Comment-Filter-23','b');}if(get_option('Cat-Comment-Filter-24')==''){update_option('Cat-Comment-Filter-24','b');}if(get_option('Cat-Comment-Filter-25')==''){update_option('Cat-Comment-Filter-25','b');}if(isset($_POST['the_option_1'])){update_option('Cat-Comment-Filter-1',$_POST['the_option_1']);}if(isset($_POST['the_option_2'])){update_option('Cat-Comment-Filter-2',$_POST['the_option_2']);}if(isset($_POST['the_option_3'])){update_option('Cat-Comment-Filter-3',$_POST['the_option_3']);}if(isset($_POST['the_option_4'])){update_option('Cat-Comment-Filter-4',$_POST['the_option_4']);}if(isset($_POST['the_option_5'])){update_option('Cat-Comment-Filter-5',$_POST['the_option_5']);}if(isset($_POST['the_option_6'])){update_option('Cat-Comment-Filter-6',$_POST['the_option_6']);}if(isset($_POST['the_option_7'])){update_option('Cat-Comment-Filter-7',$_POST['the_option_7']);}if(isset($_POST['the_option_8'])){update_option('Cat-Comment-Filter-8',$_POST['the_option_8']);}if(isset($_POST['the_option_9'])){update_option('Cat-Comment-Filter-9',$_POST['the_option_9']);}if(isset($_POST['the_option_10'])){update_option('Cat-Comment-Filter-10',$_POST['the_option_10']);}if(isset($_POST['the_option_11'])){update_option('Cat-Comment-Filter-11',$_POST['the_option_11']);}if(isset($_POST['the_option_15'])){update_option('Cat-Comment-Filter-15',$_POST['the_option_15']);}if(isset($_POST['the_option_16'])){update_option('Cat-Comment-Filter-16',$_POST['the_option_16']);}if(isset($_POST['the_option_17'])){update_option('Cat-Comment-Filter-17',$_POST['the_option_17']);}if(isset($_POST['the_option_18'])){update_option('Cat-Comment-Filter-18',$_POST['the_option_18']);}if(isset($_POST['the_option_19'])){update_option('Cat-Comment-Filter-19',$_POST['the_option_19']);}if(isset($_POST['the_option_20'])){update_option('Cat-Comment-Filter-20',$_POST['the_option_20']);}if(isset($_POST['the_option_21'])){update_option('Cat-Comment-Filter-21',$_POST['the_option_21']);}if(isset($_POST['the_option_22'])){update_option('Cat-Comment-Filter-22',$_POST['the_option_22']);}if(isset($_POST['the_option_23'])){update_option('Cat-Comment-Filter-23',$_POST['the_option_23']);}if(isset($_POST['the_option_24'])){update_option('Cat-Comment-Filter-24',$_POST['the_option_24']);}if(isset($_POST['the_option_25'])){update_option('Cat-Comment-Filter-25',$_POST['the_option_25']);}if((isset($_POST['rest']))&&($_POST['rest']=='b')){update_option('Cat-Comment-Filter-1','');update_option('Cat-Comment-Filter-2','');update_option('Cat-Comment-Filter-3','');update_option('Cat-Comment-Filter-4','');update_option('Cat-Comment-Filter-5','');update_option('Cat-Comment-Filter-6','');update_option('Cat-Comment-Filter-7','');update_option('Cat-Comment-Filter-8','');update_option('Cat-Comment-Filter-9','');update_option('Cat-Comment-Filter-10','');update_option('Cat-Comment-Filter-11','');update_option('Cat-Comment-Filter-15','');update_option('Cat-Comment-Filter-16','');update_option('Cat-Comment-Filter-17','');update_option('Cat-Comment-Filter-18','');update_option('Cat-Comment-Filter-19','');update_option('Cat-Comment-Filter-20','');update_option('Cat-Comment-Filter-21','');update_option('Cat-Comment-Filter-22','');update_option('Cat-Comment-Filter-23','');update_option('Cat-Comment-Filter-24','');update_option('Cat-Comment-Filter-25','');}update_option('Cat-Comment-Filter-12','');update_option('Cat-Comment-Filter-13','');update_option('Cat-Comment-Filter-14','');function The_page_M1(){  ?><div class="update-nag">    欢迎使用“大猫评论内容关键词过滤”插件。本插用于过滤文章和评论中不应该出现的词汇，本插件自带数据库。本插件作者享有本插件所有版权，请不要将插件用于非法用途。</div>    <div id="icon-options-general" class="icon32"><br /></div><h2>大猫评论内容关键词过滤设置</h2>    <form action="#" method="post">    <div>        <h3>自带数据库设置</h3>            自带数据库转换等级：            <select name="the_option_1">                <option value="a" <?php  if(get_option('Cat-Comment-Filter-1')=='a')echo'selected="selected"';  ?>>低</option>                <option value="b" <?php  if(get_option('Cat-Comment-Filter-1')=='b')echo'selected="selected"';  ?>>中</option>                <option value="c" <?php  if(get_option('Cat-Comment-Filter-1')=='c')echo'selected="selected"';  ?>>高</option>            </select>        </div>        <div>            自带数据库替换字：            <input type="text" name="the_option_2" value="<?php  echo get_option('Cat-Comment-Filter-2');  ?>">        </div>        <div>        <h3>自定义数据库</h3>        <textarea rows="10" cols="60" name="the_option_4"><?php  echo get_option('Cat-Comment-Filter-4')  ?></textarea><br />        自定义数据库间隔符：        <input type="text" name="the_option_5" value="<?php  echo get_option('Cat-Comment-Filter-5');  ?>"><br />        自定义删除替代字符：        <input type="text" name="the_option_6" value="<?php  echo get_option('Cat-Comment-Filter-6');  ?>"><br />        请按照下列规则添加数据：<br />例如将“您好”转换为“你好”、“您们”转换为“你们”就可以像下面这样编写规则：<br />您好<?php  echo get_option('Cat-Comment-Filter-5');  ?>你好<?php  echo get_option('Cat-Comment-Filter-5');  ?>您们<?php  echo get_option('Cat-Comment-Filter-5');  ?>你们<br />如果您要将文章中的所有“您好”删掉，可以利用以下规则添加：<br />        您好<?php  echo get_option('Cat-Comment-Filter-5');  ?><?php  echo get_option('Cat-Comment-Filter-6');  ?><?php  echo get_option('Cat-Comment-Filter-5');  ?>您们<?php  echo get_option('Cat-Comment-Filter-5');  ?>你们<br />        在规则中“<?php  echo get_option('Cat-Comment-Filter-5');  ?>”是间隔符“<?php  echo get_option('Cat-Comment-Filter-6');  ?>”代表空白字符，也就是删除。        </div>        <div>        <h3>正则表达式</h3>        是否忽略大小写：忽略：<input type="radio" <?php  if(get_option('Cat-Comment-Filter-15')=='a')echo'checked="checked"';  ?> name="the_option_15" value="a" />        不忽略：<input type="radio" <?php  if(get_option('Cat-Comment-Filter-15')=='b')echo'checked="checked"';  ?> name="the_option_15" value="b" /><br />由于受到 PHP 提交限制和数据库写入的特殊字符转译，所以正则表达式暂不提供后台编辑功能，请直接访问插件目录下的 ereg.php 填入正则表达式。<br />ereg.php 的写入方式为：<strong>"表达式","替换内容","表达式","替换内容","表达式","替换内容"</strong>这样，请注意，最后一个替换内容后面不加逗号。<br />正则表达式请使用标准 PHP 规则编写。        </div>        <div>        <h3>转换内容</h3>        是否转换评论<br />是：<input type="radio" <?php  if(get_option('Cat-Comment-Filter-3')=='a')echo'checked="checked"';  ?> name="the_option_3" value="a" />            否：<input type="radio" <?php  if(get_option('Cat-Comment-Filter-3')=='b')echo'checked="checked"';  ?> name="the_option_3" value="b" /><br />            转换评论使用数据库：<br />            自带：<select name="the_option_16"><option value="a" <?php  if(get_option('Cat-Comment-Filter-16')=='a')echo'selected="selected"';  ?>>是</option><option value="b" <?php  if(get_option('Cat-Comment-Filter-16')=='b')echo'selected="selected"';  ?>>否</option></select>            自定义：<select name="the_option_17"><option value="a" <?php  if(get_option('Cat-Comment-Filter-17')=='a')echo'selected="selected"';  ?>>是</option><option value="b" <?php  if(get_option('Cat-Comment-Filter-17')=='b')echo'selected="selected"';  ?>>否</option></select>            正则表达式：<select name="the_option_18"><option value="a" <?php  if(get_option('Cat-Comment-Filter-18')=='a')echo'selected="selected"';  ?>>是</option><option value="b" <?php  if(get_option('Cat-Comment-Filter-18')=='b')echo'selected="selected"';  ?>>否</option></select>            全部启用：<select name="the_option_7"><option value="a" <?php  if(get_option('Cat-Comment-Filter-7')=='a')echo'selected="selected"';  ?>>否</option><option value="d" <?php  if(get_option('Cat-Comment-Filter-7')=='d')echo'selected="selected"';  ?>>是</option></select><br />            是否转换文章<br />是：<input type="radio" <?php  if(get_option('Cat-Comment-Filter-8')=='a')echo'checked="checked"';  ?> name="the_option_8" value="a" />            否：<input type="radio" <?php  if(get_option('Cat-Comment-Filter-8')=='b')echo'checked="checked"';  ?> name="the_option_8" value="b" /><br />            转换文章使用数据库：<br />            自带：<select name="the_option_19"><option value="a" <?php  if(get_option('Cat-Comment-Filter-19')=='a')echo'selected="selected"';  ?>>是</option><option value="b" <?php  if(get_option('Cat-Comment-Filter-19')=='b')echo'selected="selected"';  ?>>否</option></select>            自定义：<select name="the_option_20"><option value="a" <?php  if(get_option('Cat-Comment-Filter-20')=='a')echo'selected="selected"';  ?>>是</option><option value="b" <?php  if(get_option('Cat-Comment-Filter-20')=='b')echo'selected="selected"';  ?>>否</option></select>            正则表达式：<select name="the_option_21"><option value="a" <?php  if(get_option('Cat-Comment-Filter-21')=='a')echo'selected="selected"';  ?>>是</option><option value="b" <?php  if(get_option('Cat-Comment-Filter-21')=='b')echo'selected="selected"';  ?>>否</option></select>            全部启用：<select name="the_option_10"><option value="a" <?php  if(get_option('Cat-Comment-Filter-10')=='a')echo'selected="selected"';  ?>>否</option><option value="d" <?php  if(get_option('Cat-Comment-Filter-10')=='d')echo'selected="selected"';  ?>>是</option></select><br />            是否转换文章标题<br />是：<input type="radio" <?php  if(get_option('Cat-Comment-Filter-9')=='a')echo'checked="checked"';  ?> name="the_option_9" value="a" />            否：<input type="radio" <?php  if(get_option('Cat-Comment-Filter-9')=='b')echo'checked="checked"';  ?> name="the_option_9" value="b" /><br />            转换文章标题使用数据库：<br />            自带：<select name="the_option_22"><option value="a" <?php  if(get_option('Cat-Comment-Filter-22')=='a')echo'selected="selected"';  ?>>是</option><option value="b" <?php  if(get_option('Cat-Comment-Filter-22')=='b')echo'selected="selected"';  ?>>否</option></select>            自定义：<select name="the_option_23"><option value="a" <?php  if(get_option('Cat-Comment-Filter-23')=='a')echo'selected="selected"';  ?>>是</option><option value="b" <?php  if(get_option('Cat-Comment-Filter-23')=='b')echo'selected="selected"';  ?>>否</option></select>            正则表达式：<select name="the_option_24"><option value="a" <?php  if(get_option('Cat-Comment-Filter-24')=='a')echo'selected="selected"';  ?>>是</option><option value="b" <?php  if(get_option('Cat-Comment-Filter-24')=='b')echo'selected="selected"';  ?>>否</option></select>            全部启用：<select name="the_option_11"><option value="a" <?php  if(get_option('Cat-Comment-Filter-11')=='a')echo'selected="selected"';  ?>>否</option><option value="d" <?php  if(get_option('Cat-Comment-Filter-11')=='d')echo'selected="selected"';  ?>>是</option></select><br />        </div>        <div>        <h3>清空数据库</h3>        是否清空数据库：            <select name="rest">                <option value="a" selected="selected" >否</option>                <option value="b" >是</option>            </select><br />            本选项用于卸载或者重新安装插件，选择“是”并点击“保存设置”之后所有插件配置均会被删除，此时你可以卸载插件，知道您重新访问当前页面。        </div>        <input class="button-primary" type="submit" value="保存设置" /></form><?php  }function The_page(){add_submenu_page('options-general.php','大猫评论内容关键词过滤','大猫评论内容关键词过滤设置','manage_options','Cat-Comment-Filter','The_page_M1');}add_action('admin_menu','The_page');function Cat_TH_1($content){include('ereg.php');$TheUesId=0;while((isset($TheUserEreg[$TheUesId]))&&(isset($TheUserEreg[$TheUesId+1]))){if(get_option('Cat-Comment-Filter-15')=='b'){$content = ereg_replace($TheUserEreg[$TheUesId],$TheUserEreg[$TheUesId+1],$content);}else{$content = eregi_replace($TheUserEreg[$TheUesId],$TheUserEreg[$TheUesId+1],$content);}$TheUesId = $TheUesId+2;}return $content;}function Cat_TH_2($content){$The_hehe = get_option('Cat-Comment-Filter-2');if(get_option('Cat-Comment-Filter-1')=='a'){include('mgc_1.php');}else if(get_option('Cat-Comment-Filter-1')=='b'){include('mgc_2.php');}else if(get_option('Cat-Comment-Filter-1')=='c'){include('mgc_3.php');}$content = strtr($content,$The_MGC_low);return $content;}function Cat_TH_3($content){$The_user_ku_b = explode(get_option('Cat-Comment-Filter-5'),get_option('Cat-Comment-Filter-4'));$The_user_ku = array();$i=0;$bllo=0;while($bllo==0){if((isset($The_user_ku_b[$i]))&&(isset($The_user_ku_b[$i+1]))){if($The_user_ku_b[$i+1]==get_option('Cat-Comment-Filter-6')){$The_user_ku[$The_user_ku_b[$i]]='';}else{$The_user_ku[$The_user_ku_b[$i]]=$The_user_ku_b[$i+1];}$i=$i+2;}else{$bllo=1;}}$content = strtr($content,$The_user_ku);return $content;}if(get_option('Cat-Comment-Filter-3')=='a'){if((get_option('Cat-Comment-Filter-18')=='a')||(get_option('Cat-Comment-Filter-7')=='d')){add_filter('comment_text','Cat_TH_1');}if((get_option('Cat-Comment-Filter-16')=='a')||(get_option('Cat-Comment-Filter-7')=='d')){add_filter('comment_text','Cat_TH_2');}if((get_option('Cat-Comment-Filter-17')=='a')||(get_option('Cat-Comment-Filter-7')=='d')){add_filter('comment_text','Cat_TH_3');}}if(get_option('Cat-Comment-Filter-8')=='a'){if((get_option('Cat-Comment-Filter-21')=='a')||(get_option('Cat-Comment-Filter-10')=='d')){add_filter('the_content','Cat_TH_1');}if((get_option('Cat-Comment-Filter-19')=='a')||(get_option('Cat-Comment-Filter-10')=='d')){add_filter('the_content','Cat_TH_2');}if((get_option('Cat-Comment-Filter-20')=='a')||(get_option('Cat-Comment-Filter-10')=='d')){add_filter('the_content','Cat_TH_3');}}if(get_option('Cat-Comment-Filter-9')=='a'){if((get_option('Cat-Comment-Filter-24')=='a')||(get_option('Cat-Comment-Filter-11')=='d')){add_filter('the_title','Cat_TH_1');}if((get_option('Cat-Comment-Filter-22')=='a')||(get_option('Cat-Comment-Filter-11')=='d')){add_filter('the_title','Cat_TH_2');}if((get_option('Cat-Comment-Filter-23')=='a')||(get_option('Cat-Comment-Filter-11')=='d')){add_filter('the_title','Cat_TH_3');}} ?>